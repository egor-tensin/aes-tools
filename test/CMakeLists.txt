set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} /SAFESEH:NO")

macro(test prefix)
    add_executable(test_${prefix}_encrypt ${prefix}_encrypt.c)
    target_link_libraries(test_${prefix}_encrypt libaesni)
    set_target_properties(test_${prefix}_encrypt PROPERTIES OUTPUT_NAME ${prefix}_encrypt)

    add_executable(test_${prefix}_decrypt ${prefix}_decrypt.c)
    target_link_libraries(test_${prefix}_decrypt libaesni)
    set_target_properties(test_${prefix}_decrypt PROPERTIES OUTPUT_NAME ${prefix}_decrypt)
endmacro()

test(aes128ecb)
test(aes128cbc)
test(aes128cfb)
test(aes128ofb)
test(aes128ctr)
test(aes192ecb)
test(aes192cbc)
test(aes192cfb)
test(aes192ofb)
test(aes192ctr)
test(aes256ecb)
test(aes256cbc)
test(aes256cfb)
test(aes256ofb)
test(aes256ctr)
